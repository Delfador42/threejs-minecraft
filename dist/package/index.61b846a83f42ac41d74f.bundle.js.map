{"version":3,"sources":["webpack:///./src/utils/setting/GlobalSetting.js","webpack:///./src/utils/objects/cube/CubeFactory.js","webpack:///./src/utils/stats/StatsWindow.js","webpack:///./src/utils/basic/Light.js","webpack:///./src/utils/controls/ShowOrbitControl.js","webpack:///./src/utils/objects/cube/DefaultCube.js","webpack:///./src/utils/controls/MCFirstPersonControl.js","webpack:///./src/index.js","webpack:///./src/utils/basic/Scene.js","webpack:///./src/utils/basic/Camera.js","webpack:///./src/utils/basic/Renderer.js","webpack:///./src/utils/controls/ControlBuilder.js","webpack:///./src/utils/sound/Bgm.js"],"names":["enableShadow","defaultCube","_instanceObj","key","this","cubeOptions","_materials","_materialsMap","_materialsHalfMap","_geometry","undefined","_geometryMap","_cubeSize","initMaterials","initGeometry","isHalfCube","cubeAttributes","length","textureLoader","textureList","imageUrlIndex","images","imageUrl","push","texture","load","generateMipmaps","minFilter","magFilter","materialList","textureIndex","map","fog","materialParameters","materialParametersForOneList","keyIndex","imageSet","materialTmp","indexOf","console","log","materialNew","clone","textureNew","wrapS","wrapT","repeat","set","x","y","z","rotateX","rotateY","rotateZ","position","rotation","mesh","receiveShadow","castShadow","GlobalSetting","userData","fullCubePosition","cubeTypeKey","meshParameters","rotateEnable","Math","PI","name","canvasElId","_instance","stats","domElement","style","left","top","document","getElementById","appendChild","getAmbientLightIntensity","lightCurrentIntensity","lightHighIntensity","lightLowIntensity","min","max","getDirectionalLightIntensity","camera","controls","OrbitControls","dampingFactor","enablePan","objects","window","addEventListener","event","clickedObjects","raycaster","mouse","clientX","innerWidth","clientY","innerHeight","setFromCamera","intersectObjects","getClickedObject","obj","object","grass","color","isPenetrable","isIndestructible","test","dirt","cobblestone","cobblestone_mossy","stone","stone_slab","brick","planks_birch","planks_acacia","planks_jungle","planks_oak","planks_spruce","log_acacia","leaves_acacia","transparent","leaves_acacia_opaque","log_birch","leaves_birch","leaves_birch_opaque","log_jungle","leaves_jungle","leaves_jungle_opaque","log_oak","leaves_oak","leaves_oak_opaque","log_spruce","leaves_spruce","leaves_spruce_opaque","glass","melon","pumpkin_face_off","pumpkin_face_on","test_half","opacity","stone_slab_half","brick_half","planks_birch_half","planks_acacia_half","planks_jungle_half","planks_oak_half","planks_spruce_half","scene","currentCubeTypeIndex","checkRay","X0","X1","Z0","Z1","Y0","Y1","moveForward","moveBackward","moveLeft","moveRight","preRuning","isRunning","canJump","velocity","direction","worldOption","g","personOption","height","sightHeight","jumpHeight","speedWalk","speedRun","accelerateRateStart","accelerateRateStop","thickness","init","PointerLockControls","blocker","createElement","zIndex","width","id","body","append","lock","display","aimX","setAimStyle","aimY","keyCode","performance","now","sqrt","i","initMouseFunction","initPreviewCube","delta","isLocked","Number","normalize","velocityXZMax","velocityZTmp","abs","velocityXTmp","positionBeforeX","getObject","positionBeforeZ","checkPositionOptions","rayMove","Z0NearFlatTmp","Z0Flat","ray","origin","copy","floor","intersections","point","Z1NearFlatTmp","Z1Flat","nextZ","X0NearFlatTmp","X0Flat","X1NearFlatTmp","X1Flat","nextX","bottomFlatY","bottomFlatYTmp","topFlatY","topFlatYTmp","nextY","updatePreviewCube","aim","distance","face","normal","rotate","targetIsHalfCube","DefaultCube","newIsHalfCube","Object","keys","newPositionVector","applyAxisAngle","round","yMove","newPosition","positionArray","positionTmp","checkPositionIsExistBlock","button","newDirectionRotate","newDirection","worldDirection","getWorldDirection","cube","buildCube","add","index","findIndex","e","splice","remove","getObjectById","wheelDelta","changeCurrentCubeTypeIndex","detail","onmousewheel","isNext","plusValue","result","previewCube","geometryMap","previewCubeType","geometry","previewGeometry","getCurrentCubeTypeIndex","scale","material","previewCubeRotation","aimEl","transform","fontSize","fontWeight","textAlign","verticalAlign","lineHeight","fontFamily","backgroundColor","type","divEl","spanEl1","innerText","spanEl2","spanEl3","spanEl4","isWebGLAvailable","getWebGLErrorMessage","lightDirectional","canvasEL","backgroundType","textureCube","background","cubeShader","uniforms","value","fragmentShader","vertexShader","depthWrite","side","cubeWithPic","initScene","lightAmbient","light","setHex","intensity","initAmbientLight","shadow","radius","initDirectionalLight","fov","near","far","initCamera","aspect","offsetWidth","offsetHeight","updateProjectionMatrix","renderer","shadowMap","enabled","setClearColor","initRenderer","setSize","setPixelRatio","devicePixelRatio","controlsType","showOrbitControl","initClickFunction","children","initControls","lightOption","current","low","high","becomeHigher","cubeFactory","testBlock","mountainHeight","zValue","xValue","yValue","cubeType","values","idHalfCube","cubeInfo","prevTime","animate","requestAnimationFrame","time","update","render","changeLight","onresize","onload","audioBGM","currentIndex","arr","Audio","preload","autoplay","hidden","right","loop","src","play","playHandler","removeEventListener","initBGMPlayer"],"mappings":"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","file":"package/index.61b846a83f42ac41d74f.bundle.js","sourcesContent":["export default {\r\n    enableShadow:false\r\n}","import * as THREE from 'three';\r\nimport GlobalSetting from \"../../setting/GlobalSetting\";\r\n\r\nexport default class CubeFactory {\r\n    constructor(defaultCube) {\r\n        if (CubeFactory._instanceObj && CubeFactory._instanceObj[defaultCube.key]) {\r\n            return CubeFactory._instanceObj[defaultCube.key];\r\n        }\r\n        this.cubeOptions = defaultCube;\r\n        this._materials = [];\r\n        this._materialsMap = {};\r\n        this._materialsHalfMap = {};\r\n        this._geometry = undefined;\r\n        this._geometryMap = {};\r\n        this._cubeSize = 1;//方块边长，只能为1\r\n        this.initMaterials();\r\n        this.initGeometry();\r\n        CubeFactory._instanceObj = {\r\n            [defaultCube.key]: this\r\n        }\r\n    }\r\n\r\n    //初始化形状\r\n    initGeometry() {\r\n        if (this._geometryMap) {\r\n            this._geometry = this._geometryMap[this.cubeOptions.key];\r\n        }\r\n        if (this._geometry) {\r\n            return;\r\n        }\r\n\r\n        let isHalfCube = (this.cubeOptions.cubeAttributes !== undefined) && this.cubeOptions.cubeAttributes.isHalfCube;\r\n        this._geometry = new THREE.CubeGeometry(this._cubeSize, this._cubeSize / (isHalfCube ? 2 : 1), this._cubeSize);\r\n\r\n        this._geometryMap[this.cubeOptions.key] = this._geometry\r\n    }\r\n\r\n    //初始化材质\r\n    initMaterials() {\r\n        if (this._materialsMap) {\r\n            this._materials = this._materialsMap[this.cubeOptions.key];\r\n        }\r\n        if (this._materials && this._materials.length !== 0) {\r\n            return;\r\n        }\r\n        this._materials = [];\r\n        let textureLoader = new THREE.TextureLoader();\r\n        let textureList = [];\r\n        for (let imageUrlIndex in this.cubeOptions.images) {\r\n            let imageUrl = this.cubeOptions.images[imageUrlIndex]\r\n            if (imageUrl === '' || imageUrl === undefined) {\r\n                textureList.push(undefined);\r\n            } else {\r\n                let texture = textureLoader.load(imageUrl);\r\n                texture.generateMipmaps = true;//生成纹理，用于相关滤镜，根据远近自动调整贴图质量\r\n                texture.minFilter = THREE.NearestMipMapNearestFilter;//minFilter属性：指定纹理如何缩小。默认值：THREE.LinearMipMapLinearFilter。\r\n                texture.magFilter = THREE.NearestFilter;//magFilter属性：指定纹理如何放大。THREE.NearestFilter 贴图像素化\r\n                textureList.push(texture);\r\n            }\r\n        }\r\n        let materialList = [];\r\n        for (let textureIndex in textureList) {\r\n            let texture = textureList[textureIndex];\r\n\r\n            materialList.push(\r\n                new THREE.MeshLambertMaterial({\r\n                    // color:0x4F9C1A,\r\n                    // side: THREE.DoubleSide,\r\n                    map: texture,\r\n                    // vertexColors: THREE.VertexColors,\r\n                    fog: true,//当前材质是否受到全局雾化效果器影响\r\n                    ...(this.cubeOptions.materialParameters ? this.cubeOptions.materialParameters : {}),\r\n                    ...(this.cubeOptions.materialParametersForOneList && this.cubeOptions.materialParametersForOneList[textureIndex] ? this.cubeOptions.materialParametersForOneList[textureIndex] : {}),\r\n                })\r\n            );\r\n        }\r\n        //半高贴图\r\n        let isHalfCube = (this.cubeOptions.cubeAttributes !== undefined) && this.cubeOptions.cubeAttributes.isHalfCube;\r\n\r\n        for (let keyIndex in this.cubeOptions.imageSet) {\r\n            let key = this.cubeOptions.imageSet[keyIndex];\r\n            let materialTmp = materialList[key];\r\n            if (isHalfCube) {\r\n                if (\"0145\".indexOf(keyIndex) >= 0) {\r\n                    if (!this._materialsHalfMap) {\r\n                        this._materialsHalfMap = {}\r\n                    }\r\n                    if (this._materialsHalfMap[this.cubeOptions.key]) {\r\n                        console.log(\"侧面贴图\")\r\n                        materialTmp = this._materialsHalfMap[this.cubeOptions.key];\r\n                    } else if (materialTmp.map) {\r\n                        let materialNew = materialTmp.clone();\r\n                        materialNew.map = materialTmp.map.clone();\r\n                        let textureNew = textureLoader.load(this.cubeOptions.images[this.cubeOptions.imageSet[keyIndex]]);\r\n                        textureNew.generateMipmaps = true;\r\n                        textureNew.minFilter = THREE.NearestMipMapNearestFilter;\r\n                        textureNew.magFilter = THREE.NearestFilter;\r\n                        textureNew.wrapS = textureNew.wrapT = THREE.RepeatWrapping;\r\n                        textureNew.repeat.set(1, 0.5);\r\n                        materialNew.map = textureNew;\r\n                        materialTmp = materialNew;\r\n                        this._materialsHalfMap[this.cubeOptions.key] = materialTmp;\r\n                    }\r\n                }\r\n            }\r\n            this._materials.push(materialTmp);\r\n        }\r\n        this._materialsMap[this.cubeOptions.key] = this._materials;\r\n    };\r\n\r\n\r\n    //构造方块\r\n    buildCube(x, y, z, defaultCube, rotateX, rotateY, rotateZ) {\r\n        let position = {x: x, y: y, z: z};\r\n        let rotation = {rotateX: rotateX, rotateY: rotateY, rotateZ: rotateZ};\r\n        if (defaultCube) {\r\n            this.cubeOptions = defaultCube;\r\n            this.initGeometry();\r\n            this.initMaterials();\r\n        }\r\n        position.x = position.x || 0;\r\n        position.y = position.y || 0;\r\n        position.z = position.z || 0;\r\n        let mesh = new THREE.Mesh(\r\n            this._geometry,\r\n            this._materials\r\n            // new THREE.MeshLambertMaterial({color: 0x00cc00})\r\n        );\r\n        mesh.receiveShadow = mesh.castShadow = GlobalSetting.enableShadow;\r\n        //新方块中心位置\r\n        {\r\n            mesh.position.x = position.x;\r\n            mesh.position.y = position.y;\r\n            mesh.position.z = position.z;\r\n            mesh.userData = {\r\n                fullCubePosition: {\r\n                    x: mesh.position.x,\r\n                    y: mesh.position.y,\r\n                    z: mesh.position.z,\r\n                },\r\n                cubeTypeKey: this.cubeOptions.key,\r\n            };\r\n        }\r\n        if (rotation.rotateX && (defaultCube.meshParameters && defaultCube.meshParameters.rotateEnable && defaultCube.meshParameters.rotateEnable.x)) {\r\n            mesh.rotateX(rotation.rotateX * Math.PI / 180);\r\n        }\r\n        if (rotation.rotateY && (defaultCube.meshParameters && defaultCube.meshParameters.rotateEnable && defaultCube.meshParameters.rotateEnable.y)) {\r\n            mesh.rotateY(rotation.rotateY * Math.PI / 180);\r\n        }\r\n        if (rotation.rotateZ && (defaultCube.meshParameters && defaultCube.meshParameters.rotateEnable && defaultCube.meshParameters.rotateEnable.z)) {\r\n            mesh.rotateZ(rotation.rotateZ * Math.PI / 180);\r\n        }\r\n        mesh.name = this.cubeOptions.key + \"(\" + position.x + \",\" + position.y + \",\" + position.z + \")\";\r\n        return mesh;\r\n    }\r\n}","// 查看信息小控件\r\nimport Stats from \"stats-js\";\r\nexport default class StatsWindow {\r\n    constructor(canvasElId) {\r\n        if (StatsWindow._instance) {\r\n            return StatsWindow._instance;\r\n        }\r\n        let stats;\r\n        stats = new Stats();\r\n        stats.domElement.style.position = 'absolute';\r\n        stats.domElement.style.left = '0px';\r\n        stats.domElement.style.top = '0px';\r\n        document.getElementById(canvasElId).appendChild(stats.domElement);\r\n        StatsWindow._instance = this;\r\n        this.stats=stats;\r\n        return this;\r\n    }\r\n}\r\n\r\n","import * as THREE from \"three\";\r\nimport GlobalSetting from \"../setting/GlobalSetting\";\r\n\r\nexport const lightHighIntensity = 1;\r\nexport const lightLowIntensity = 0.3;\r\nexport const lightCurrentIntensity = 1;\r\nexport const lightValueBecomeHigher = true;\r\n\r\nexport function initAmbientLight() {\r\n    let light = new THREE.AmbientLight();//环境光\r\n    light.castShadow = false;\r\n    light.color = new THREE.Color().setHex(0xffffff);\r\n    light.intensity = getAmbientLightIntensity();\r\n    return light;\r\n}\r\n\r\nexport function getAmbientLightIntensity(lightCurrentIntensity, lightHighIntensity, lightLowIntensity) {\r\n    return Math.min(Math.max(lightLowIntensity, lightCurrentIntensity), lightHighIntensity);\r\n}\r\n\r\nexport function initDirectionalLight() {\r\n    let light = new THREE.DirectionalLight();//环境光\r\n    light.castShadow = GlobalSetting.enableShadow;\r\n    light.color = new THREE.Color().setHex(0xffffff);\r\n    light.intensity = getDirectionalLightIntensity();\r\n    light.shadow.radius = 512;\r\n    light.position.x = 10;\r\n    light.position.y = -10;\r\n    light.position.z = 10;\r\n    return light;\r\n}\r\n\r\nexport function getDirectionalLightIntensity(lightCurrentIntensity, lightHighIntensity, lightLowIntensity) {\r\n    return Math.min(Math.max(lightLowIntensity, lightCurrentIntensity), lightHighIntensity) / 4;\r\n}\r\n","import {OrbitControls} from 'three/examples/jsm/controls/OrbitControls'\r\nimport * as THREE from 'three';\r\nexport default class ShowOrbitControl {\r\n\r\n    constructor(camera, domElement) {\r\n        // ShowOrbitControl._instance;\r\n        // this.controls;\r\n        this.camera = camera;\r\n        if (ShowOrbitControl._instance) {\r\n            return ShowOrbitControl._instance;\r\n        }\r\n        this.controls = new OrbitControls(camera, domElement);\r\n        //动态阻尼系数 就是鼠标拖拽旋转灵敏度\r\n        this.controls.dampingFactor = 1;\r\n        //是否允许平移\r\n        this.controls.enablePan = false;\r\n        ShowOrbitControl._instance = this;\r\n        return ShowOrbitControl._instance;\r\n    }\r\n\r\n    initClickFunction(objects, camera) {\r\n        window.addEventListener('mousedown', (event) => {\r\n            let clickedObjects = getClickedObject(event, objects, this.camera);\r\n            if (clickedObjects.length > 0) {\r\n                let obj = clickedObjects[0].object;\r\n                console.log(\"点击的对象：\" + obj.name);\r\n            }\r\n        }, false);\r\n    }\r\n}\r\n\r\n//获取点击的对象\r\nfunction getClickedObject(event, objects, camera) {\r\n    let raycaster = new THREE.Raycaster();\r\n    let mouse = new THREE.Vector2();\r\n    //通过鼠标点击的位置计算出raycaster所需要的点的位置，以屏幕中心为原点，值的范围为-1到1.\r\n    mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\r\n    mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\r\n    // 通过鼠标点的位置和当前相机的矩阵计算出raycaster\r\n    raycaster.setFromCamera(mouse, camera);\r\n    // 获取raycaster直线和所有模型相交的数组集合\r\n    return raycaster.intersectObjects(objects);\r\n}\r\n\r\n\r\n","//预设方块信息\r\nimport * as THREE from 'three'\r\n\r\nexport default {\r\n    grass: {\r\n        key: 'grass',//设置和对象key一样\r\n        images: [//贴图路径\r\n            './assets/img/blocks/grass_side.png',\r\n            './assets/img/blocks/grass_top.png',\r\n            './assets/img/blocks/dirt.png',\r\n        ],\r\n        imageSet: [0, 0, 1, 2, 0, 0],//六面贴图使用的images图片下标\r\n        materialParameters: {},//THREE.MeshXxxMaterial 对象参数，六面都影响\r\n        materialParametersForOneList: [//THREE.MeshXxxMaterial 对象参数，只影响对应的一个面\r\n            {},\r\n            {color: 0xB1FB6C},\r\n        ],\r\n        meshParameters: {\r\n            rotateEnable: {//放置方块时，旋转辅助参数，是否可在对应轴上旋转\r\n                x: false,\r\n                y: false,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,//不能碰撞。false-能踩能撞\r\n            isIndestructible: false,//不能销毁。false-左键点击能消除\r\n            isHalfCube: false,//是半砖。false-不是半砖。true-是一个半砖，可以在一个1x1x1内叠加另一个半砖\r\n        },\r\n    },\r\n    test: {\r\n        key: 'test',\r\n        images: [\r\n            './assets/img/1.png',\r\n            './assets/img/2.png',\r\n            './assets/img/3.png',\r\n            './assets/img/4.png',\r\n            './assets/img/5.png',\r\n            './assets/img/6.png',\r\n        ],\r\n        imageSet: [0, 1, 2, 3, 4, 5],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: true,\r\n                y: true,\r\n                z: true,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    dirt: {\r\n        key: 'dirt',\r\n        images: [\r\n            './assets/img/blocks/dirt.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: false,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    // Cloud: {\r\n    //     key: 'Cloud',\r\n    //     images: [\r\n    //         './assets/img/blocks/grass_side.png',\r\n    //         './assets/img/blocks/grass_top_green.png',\r\n    //         './assets/img/blocks/dirt.png',\r\n    //     ],\r\n    //     imageSet: [0, 0, 1, 2, 0, 0],\r\n    //     materialParameters: {\r\n    //         transparent: true,//透明\r\n    //         opacity: 0.2,//透明度\r\n    //     }\r\n    // },\r\n    cobblestone: {\r\n        key: 'cobblestone',\r\n        images: [\r\n            './assets/img/blocks/cobblestone.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: false,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    cobblestone_mossy: {\r\n        key: 'cobblestone_mossy',\r\n        images: [\r\n            './assets/img/blocks/cobblestone_mossy.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: false,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    stone: {\r\n        key: 'stone',\r\n        images: [\r\n            './assets/img/blocks/stone.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: false,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    stone_slab: {\r\n        key: 'stone_slab',\r\n        images: [\r\n            './assets/img/blocks/stone_slab_side.png',\r\n            './assets/img/blocks/stone_slab_top.png',\r\n        ],\r\n        imageSet: [0, 0, 1, 1, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: true,\r\n                y: true,\r\n                z: true,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    brick: {\r\n        key: 'brick',\r\n        images: [\r\n            './assets/img/blocks/brick.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    planks_birch: {\r\n        key: 'planks_birch',\r\n        images: [\r\n            './assets/img/blocks/planks_birch.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    planks_acacia: {\r\n        key: 'planks_acacia',\r\n        images: [\r\n            './assets/img/blocks/planks_acacia.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    planks_jungle: {\r\n        key: 'planks_jungle',\r\n        images: [\r\n            './assets/img/blocks/planks_jungle.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    planks_oak: {\r\n        key: 'planks_oak',\r\n        images: [\r\n            './assets/img/blocks/planks_oak.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    planks_spruce: {\r\n        key: 'planks_spruce',\r\n        images: [\r\n            './assets/img/blocks/planks_spruce.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    // reeds: {\r\n    //     key: 'reeds',\r\n    //     images: [\r\n    //         './assets/img/blocks/reeds.png',\r\n    //     ],\r\n    //     imageSet: [0, 0, 0, 0, 0, 0],\r\n    //     materialParameters: {\r\n    //         transparent: true,\r\n    //         side: THREE.DoubleSide,\r\n    //     },\r\n    //     materialParametersForOneList:[]\r\n    // },\r\n\r\n    log_acacia: {\r\n        key: 'log_acacia',\r\n        images: [\r\n            './assets/img/blocks/log_acacia.png',\r\n            './assets/img/blocks/log_acacia_top.png',\r\n        ],\r\n        imageSet: [0, 0, 1, 1, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: true,\r\n                y: true,\r\n                z: true,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    leaves_acacia: {\r\n        key: 'leaves_acacia',\r\n        images: [\r\n            './assets/img/blocks/leaves_acacia.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            color: 0x89B95C,\r\n            transparent: true,\r\n        },\r\n        materialParametersForOneList: [],\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    leaves_acacia_opaque: {\r\n        key: 'leaves_acacia_opaque',\r\n        images: [\r\n            './assets/img/blocks/leaves_acacia_opaque.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            color: 0x89B95C,\r\n        },\r\n        materialParametersForOneList: [],\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n\r\n    log_birch: {\r\n        key: 'log_birch',\r\n        images: [\r\n            './assets/img/blocks/log_birch.png',\r\n            './assets/img/blocks/log_birch_top.png',\r\n        ],\r\n        imageSet: [0, 0, 1, 1, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: true,\r\n                y: true,\r\n                z: true,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    leaves_birch: {\r\n        key: 'leaves_birch',\r\n        images: [\r\n            './assets/img/blocks/leaves_birch.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            color: 0x89B95C,\r\n            transparent: true,\r\n        },\r\n        materialParametersForOneList: [],\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    leaves_birch_opaque: {\r\n        key: 'leaves_birch_opaque',\r\n        images: [\r\n            './assets/img/blocks/leaves_birch_opaque.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            color: 0x89B95C,\r\n        },\r\n        materialParametersForOneList: [],\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n\r\n    log_jungle: {\r\n        key: 'log_jungle',\r\n        images: [\r\n            './assets/img/blocks/log_jungle.png',\r\n            './assets/img/blocks/log_jungle_top.png',\r\n        ],\r\n        imageSet: [0, 0, 1, 1, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: true,\r\n                y: true,\r\n                z: true,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    leaves_jungle: {\r\n        key: 'leaves_jungle',\r\n        images: [\r\n            './assets/img/blocks/leaves_jungle.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            color: 0x89B95C,\r\n            transparent: true,\r\n        },\r\n        materialParametersForOneList: [],\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    leaves_jungle_opaque: {\r\n        key: 'leaves_jungle_opaque',\r\n        images: [\r\n            './assets/img/blocks/leaves_jungle_opaque.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            color: 0x89B95C,\r\n        },\r\n        materialParametersForOneList: [],\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n\r\n    log_oak: {\r\n        key: 'log_oak',\r\n        images: [\r\n            './assets/img/blocks/log_oak.png',\r\n            './assets/img/blocks/log_oak_top.png',\r\n        ],\r\n        imageSet: [0, 0, 1, 1, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: true,\r\n                y: true,\r\n                z: true,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    leaves_oak: {\r\n        key: 'leaves_oak',\r\n        images: [\r\n            './assets/img/blocks/leaves_oak.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            color: 0x89B95C,\r\n            transparent: true,\r\n        },\r\n        materialParametersForOneList: [],\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    leaves_oak_opaque: {\r\n        key: 'leaves_oak_opaque',\r\n        images: [\r\n            './assets/img/blocks/leaves_oak_opaque.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            color: 0x89B95C,\r\n        },\r\n        materialParametersForOneList: [],\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n\r\n    log_spruce: {\r\n        key: 'log_spruce',\r\n        images: [\r\n            './assets/img/blocks/log_spruce.png',\r\n            './assets/img/blocks/log_spruce_top.png',\r\n        ],\r\n        imageSet: [0, 0, 1, 1, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: true,\r\n                y: true,\r\n                z: true,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    leaves_spruce: {\r\n        key: 'leaves_spruce',\r\n        images: [\r\n            './assets/img/blocks/leaves_spruce.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            color: 0x89B95C,\r\n            transparent: true,\r\n        },\r\n        materialParametersForOneList: [],\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    leaves_spruce_opaque: {\r\n        key: 'leaves_spruce_opaque',\r\n        images: [\r\n            './assets/img/blocks/leaves_spruce_opaque.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            color: 0x89B95C,\r\n        },\r\n        materialParametersForOneList: [],\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    glass: {\r\n        key: 'glass',\r\n        images: [\r\n            './assets/img/blocks/glass.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            transparent: true,\r\n        },\r\n        materialParametersForOneList: [],\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    // ice: {\r\n    //     key: 'ice',\r\n    //     images: [\r\n    //         './assets/img/blocks/ice.png',\r\n    //     ],\r\n    //     imageSet: [0, 0, 0, 0, 0, 0],\r\n    //     materialParameters: {\r\n    //         transparent:true\r\n    //     },\r\n    //     materialParametersForOneList: [\r\n    //     ],\r\n    //     meshParameters: {\r\n    //         rotateEnable: {\r\n    //             x: false,\r\n    //             y: false,\r\n    //             z: false,\r\n    //         }\r\n    //     },\r\n    // },\r\n    melon: {\r\n        key: 'melon',\r\n        images: [\r\n            './assets/img/blocks/melon_side.png',\r\n            './assets/img/blocks/melon_top.png',\r\n        ],\r\n        imageSet: [0, 0, 1, 1, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: false,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    pumpkin_face_off: {\r\n        key: 'pumpkin_face_off',\r\n        images: [\r\n            './assets/img/blocks/pumpkin_face_off.png',\r\n            './assets/img/blocks/pumpkin_side.png',\r\n            './assets/img/blocks/pumpkin_top.png',\r\n        ],\r\n        imageSet: [0, 1, 2, 2, 1, 1],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    pumpkin_face_on: {\r\n        key: 'pumpkin_face_on',\r\n        images: [\r\n            './assets/img/blocks/pumpkin_face_on.png',\r\n            './assets/img/blocks/pumpkin_side.png',\r\n            './assets/img/blocks/pumpkin_top.png',\r\n        ],\r\n        imageSet: [0, 1, 2, 2, 1, 1],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: false,\r\n        },\r\n    },\r\n    test_half: {\r\n        key: 'test_half',\r\n        images: [''],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {\r\n            color: 0xFFFFFF,\r\n            transparent: true,//透明\r\n            opacity: 0.8,//透明度\r\n        },\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: true,\r\n        },\r\n    },\r\n    stone_slab_half: {\r\n        key: 'stone_slab_half',\r\n        images: [\r\n            './assets/img/blocks/stone_slab_side.png',\r\n            './assets/img/blocks/stone_slab_top.png',\r\n        ],\r\n        imageSet: [0, 0, 1, 1, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: true,\r\n        },\r\n    },\r\n    brick_half: {\r\n        key: 'brick_half',\r\n        images: [\r\n            './assets/img/blocks/brick.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: true,\r\n        },\r\n    },\r\n    planks_birch_half: {\r\n        key: 'planks_birch_half',\r\n        images: [\r\n            './assets/img/blocks/planks_birch.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: true,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: true,\r\n        },\r\n    },\r\n    planks_acacia_half: {\r\n        key: 'planks_acacia_half',\r\n        images: [\r\n            './assets/img/blocks/planks_acacia.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: true,\r\n        },\r\n    },\r\n    planks_jungle_half: {\r\n        key: 'planks_jungle_half',\r\n        images: [\r\n            './assets/img/blocks/planks_jungle.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: true,\r\n        },\r\n    },\r\n    planks_oak_half: {\r\n        key: 'planks_oak_half',\r\n        images: [\r\n            './assets/img/blocks/planks_oak.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: true,\r\n        },\r\n    },\r\n    planks_spruce_half: {\r\n        key: 'planks_spruce_half',\r\n        images: [\r\n            './assets/img/blocks/planks_spruce.png',\r\n        ],\r\n        imageSet: [0, 0, 0, 0, 0, 0],\r\n        materialParameters: {},\r\n        materialParametersForOneList: [],\r\n        meshParameters: {\r\n            rotateEnable: {\r\n                x: false,\r\n                y: true,\r\n                z: false,\r\n            }\r\n        },\r\n        cubeAttributes:{\r\n            isPenetrable: false,\r\n            isIndestructible: false,\r\n            isHalfCube: true,\r\n        },\r\n    },\r\n}","import {PointerLockControls} from 'three/examples/jsm/controls/PointerLockControls'\r\nimport CubeFactory from \"../objects/cube/CubeFactory\";\r\nimport * as THREE from 'three';\r\nimport DefaultCube from '../objects/cube/DefaultCube'\r\nimport {Vector3} from \"three\";\r\n\r\nexport default class MCFirstPersonControl {\r\n\r\n    constructor(camera, domElement, objects, scene) {\r\n        if (MCFirstPersonControl._instance) {\r\n            return MCFirstPersonControl._instance;\r\n        }\r\n        // MCFirstPersonControl._instance;\r\n        // this.controls;\r\n        // this.removeBlockTimer;//移除方块计时\r\n        // this.previewCube;//预览方块\r\n        this.camera = camera;\r\n        this.objects = objects;\r\n        this.scene = scene;\r\n        this.currentCubeTypeIndex = 0;\r\n\r\n        this.checkRay = {//0为负，1为正\r\n            X0: [],\r\n            X1: [],\r\n            Z0: [],\r\n            Z1: [],\r\n\r\n            Y0: [],\r\n            Y1: [],\r\n        };\r\n        this.moveForward = false;\r\n        this.moveBackward = false;\r\n        this.moveLeft = false;\r\n        this.moveRight = false;\r\n        this.preRuning = undefined;\r\n        this.isRunning = false;\r\n        this.canJump = false;\r\n        // this.prevTime = performance.now();\r\n        this.velocity = new THREE.Vector3();\r\n        this.direction = new THREE.Vector3();\r\n        this.worldOption = {\r\n            g: 9.0\r\n        };\r\n        this.personOption = {\r\n            height: 1.8,//人物总高度。现有配置不能让人物高于2\r\n            sightHeight: 1.5,//眼部高度。现有配置不能让人物高于2\r\n            jumpHeight: 1.3,    //最大跳跃高度(并非砖块高度)\r\n            speedWalk: 5.7,     //最大行走速度\r\n            speedRun: 10,       //最大奔跑速度，连按w两次\r\n            accelerateRateStart: 0.3,//加速时加速比率。正数向前；负数反向；0不会加速；绝对值大于等于1可立即到最大速度\r\n            accelerateRateStop: 0.8,//停止时减速比率。范围[0-1]。0时立即停止，1时不会减速\r\n            thickness: 0.6,//人物的边长\r\n        };\r\n        this.init(camera, domElement);\r\n        MCFirstPersonControl._instance = this;\r\n        return MCFirstPersonControl._instance;\r\n    }\r\n\r\n    init(camera, domElement) {\r\n        this.controls = new PointerLockControls(camera, domElement);\r\n        //增加遮罩层\r\n        {\r\n            let blocker = document.createElement(\"div\");\r\n            blocker.style.position = \"absolute\";\r\n            blocker.style.zIndex = \"100\";\r\n            blocker.style.width = \"100%\";\r\n            blocker.style.height = \"100%\";\r\n            blocker.style.top = \"0\";\r\n            blocker.style.left = \"0\";\r\n            blocker.id = \"blocker\";\r\n            // blocker.style.backgroundColor = \"rgba(0, 0, 0, 0.4)\";\r\n            document.body.append(blocker);\r\n            blocker.addEventListener('click', () => {\r\n                this.controls.lock();\r\n            }, false);\r\n            this.controls.addEventListener('lock', function () {\r\n                blocker.style.display = 'none';\r\n            });\r\n            this.controls.addEventListener('unlock', function () {\r\n                blocker.style.display = 'block';\r\n            });\r\n        }\r\n        //添加准星\r\n        {\r\n            let aimX = document.createElement(\"div\");\r\n            aimX.style.height = \"2px\";\r\n            aimX.style.width = \"20px\";\r\n            setAimStyle(aimX);\r\n            document.body.append(aimX);\r\n            let aimY = document.createElement(\"div\");\r\n            aimY.style.height = \"20px\";\r\n            aimY.style.width = \"2px\";\r\n            setAimStyle(aimY);\r\n            document.body.append(aimY);\r\n        }\r\n        //加按键事件\r\n        let onKeyDown = (event) => {\r\n            switch (event.keyCode) {\r\n                case 38: // up\r\n                case 87: // w\r\n                    if (this.moveForward) {\r\n                        break;\r\n                    }\r\n                    if (!this.preRuning) {\r\n                        this.preRuning = performance.now();\r\n                    } else {\r\n                        this.isRunning = performance.now() - this.preRuning <= 200;\r\n                        this.preRuning = performance.now();\r\n                    }\r\n                    this.moveForward = true;\r\n                    break;\r\n\r\n                case 37: // left\r\n                case 65: // a\r\n                    if (this.moveLeft) {\r\n                        break;\r\n                    }\r\n                    this.moveLeft = true;\r\n                    break;\r\n\r\n                case 40: // down\r\n                case 83: // s\r\n                    if (this.moveBackward) {\r\n                        break;\r\n                    }\r\n                    this.moveBackward = true;\r\n                    break;\r\n\r\n                case 39: // right\r\n                case 68: // d\r\n                    if (this.moveRight) {\r\n                        break;\r\n                    }\r\n                    this.moveRight = true;\r\n                    break;\r\n\r\n                case 32: // space\r\n                    //7.74是60开平方\r\n                    if (this.canJump) this.velocity.y += Math.sqrt(2 * this.worldOption.g * 7.74 * this.personOption.jumpHeight);\r\n                    this.canJump = false;\r\n                    break;\r\n\r\n            }\r\n\r\n        };\r\n        let onKeyUp = (event) => {\r\n            switch (event.keyCode) {\r\n                case 38: // up\r\n                case 87: // w\r\n                    this.isRunning = false;\r\n                    this.moveForward = false;\r\n                    break;\r\n\r\n                case 37: // left\r\n                case 65: // a\r\n                    this.moveLeft = false;\r\n                    break;\r\n\r\n                case 40: // down\r\n                case 83: // s\r\n                    this.moveBackward = false;\r\n                    break;\r\n\r\n                case 39: // right\r\n                case 68: // d\r\n                    this.moveRight = false;\r\n                    break;\r\n\r\n            }\r\n\r\n        };\r\n        document.addEventListener('keydown', onKeyDown, false);\r\n        document.addEventListener('keyup', onKeyUp, false);\r\n        //加水平方向碰撞检测  。0,1脚底；2,3腰；4,5头顶; 6,7腿中间(半砖)； 8,9头中间(半砖)\r\n        for (let i = 0; i < 10; i++) {\r\n            this.checkRay.X0.push(new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(-1, 0, 0), 0, 0));\r\n        }\r\n        for (let i = 0; i < 10; i++) {\r\n            this.checkRay.X1.push(new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(1, 0, 0), 0, 0));\r\n        }\r\n        for (let i = 0; i < 10; i++) {\r\n            this.checkRay.Z0.push(new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(0, 0, -1), 0, 0));\r\n        }\r\n        for (let i = 0; i < 10; i++) {\r\n            this.checkRay.Z1.push(new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(0, 0, 1), 0, 0));\r\n        }\r\n        //加垂直方向碰撞检测\r\n        for (let i = 0; i < 4; i++) {\r\n            this.checkRay.Y0.push(new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(0, -1, 0), 0, 0));\r\n        }\r\n        for (let i = 0; i < 4; i++) {\r\n            this.checkRay.Y1.push(new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(0, 1, 0), 0, 0));\r\n        }\r\n        //初始化点击功能\r\n        this.initMouseFunction();\r\n        //加载预览方块\r\n        this.initPreviewCube();\r\n    }\r\n\r\n    update(delta) {\r\n        // console.log(this.objects.length)\r\n        delta = delta || 0.016;\r\n        if (!this.controls.isLocked) {\r\n            this.moveForward = false;\r\n            this.moveBackward = false;\r\n            this.moveLeft = false;\r\n            this.moveRight = false;\r\n        }\r\n        //水平方向移动+碰撞检测\r\n        {\r\n            this.direction.z = Number(this.moveForward) - Number(this.moveBackward);\r\n            this.direction.x = Number(this.moveRight) - Number(this.moveLeft);\r\n            this.direction.normalize(); // this ensures consistent movements in all directions\r\n            let velocityXZMax = this.isRunning ? this.personOption.speedRun : this.personOption.speedWalk;\r\n\r\n            if (this.moveForward || this.moveBackward) {\r\n                let velocityZTmp = this.velocity.z + this.direction.z * velocityXZMax * this.personOption.accelerateRateStart;\r\n                if (Math.abs(velocityZTmp) < velocityXZMax) {\r\n                    this.velocity.z = velocityZTmp;\r\n                } else {\r\n                    this.velocity.z = this.direction.z * velocityXZMax;\r\n                }\r\n            } else {\r\n                this.velocity.z = Math.abs(this.velocity.z) > 1 ? this.velocity.z * (this.personOption.accelerateRateStop) : 0;\r\n            }\r\n\r\n            if (this.moveLeft || this.moveRight) {\r\n                let velocityXTmp = this.velocity.x + this.direction.x * velocityXZMax * this.personOption.accelerateRateStart;\r\n                if (Math.abs(velocityXTmp) < velocityXZMax) {\r\n                    this.velocity.x = velocityXTmp;\r\n                } else {\r\n                    this.velocity.x = this.direction.x * velocityXZMax;\r\n                }\r\n            } else {\r\n                this.velocity.x = Math.abs(this.velocity.x) > 1 ? this.velocity.x * (this.personOption.accelerateRateStop) : 0;\r\n            }\r\n\r\n            let positionBeforeX = this.controls.getObject().position.x;\r\n            let positionBeforeZ = this.controls.getObject().position.z;\r\n\r\n            this.controls.moveForward(this.velocity.z * delta);\r\n            this.controls.moveRight(this.velocity.x * delta);\r\n\r\n            //横向碰撞检测辅助参数\r\n            const checkPositionOptions = [\r\n                -(this.personOption.sightHeight - 0.05),\r\n                -(this.personOption.sightHeight - this.personOption.height / 2),\r\n                (this.personOption.height - this.personOption.sightHeight - 0.05),\r\n                -(this.personOption.sightHeight - 0.5),\r\n                (this.personOption.height - this.personOption.sightHeight - 0.5)\r\n            ];\r\n            let rayMove = this.personOption.thickness / 2;\r\n\r\n            {//z轴碰撞检测\r\n\r\n                let Z0Flat = undefined;//z负轴碰撞检测\r\n                let Z0NearFlatTmp;\r\n                {\r\n                    for (let i = 0; i < 10; i++) {\r\n                        this.checkRay.Z0[i].ray.origin.copy(this.controls.getObject().position);//设置射线原点在摄像机位置，即人物眼睛位置\r\n                        this.checkRay.Z0[i].ray.origin.x = positionBeforeX;//修正为移动前的x轴位置，防止使用位移后的位置检测墙壁\r\n                        this.checkRay.Z0[i].ray.origin.x += (i % 2 === 0 ? 1 : -1) * rayMove;\r\n                        this.checkRay.Z0[i].ray.origin.y += checkPositionOptions[Math.floor(i / 2)];\r\n                        let intersections = this.checkRay.Z0[i].intersectObjects(this.objects);\r\n                        if (intersections.length > 0) {\r\n                            Z0NearFlatTmp = intersections[0].point.z;\r\n                            Z0Flat = Math.max(Z0Flat === undefined ? Z0NearFlatTmp : Z0Flat, Z0NearFlatTmp);\r\n                        }\r\n                    }\r\n                }\r\n                let Z1Flat = undefined;//z正轴碰撞检测\r\n                let Z1NearFlatTmp;\r\n                {\r\n                    for (let i = 0; i < 10; i++) {\r\n                        this.checkRay.Z1[i].ray.origin.copy(this.controls.getObject().position);//设置射线原点在摄像机位置，即人物眼睛位置\r\n                        this.checkRay.Z1[i].ray.origin.x = positionBeforeX;\r\n                        this.checkRay.Z1[i].ray.origin.x += (i % 2 === 0 ? 1 : -1) * rayMove;\r\n                        this.checkRay.Z1[i].ray.origin.y += checkPositionOptions[Math.floor(i / 2)];\r\n                        let intersections = this.checkRay.Z1[i].intersectObjects(this.objects);\r\n                        if (intersections.length > 0) {\r\n                            Z1NearFlatTmp = intersections[0].point.z;\r\n                            Z1Flat = Math.min(Z1Flat === undefined ? Z1NearFlatTmp : Z1Flat, Z1NearFlatTmp);\r\n                        }\r\n                    }\r\n                }\r\n                let nextZ = this.controls.getObject().position.z;\r\n                nextZ = Math.min(Z1Flat === undefined ? nextZ : (Z1Flat - this.personOption.thickness / 2 - 0.01), nextZ);\r\n                nextZ = Math.max(Z0Flat === undefined ? nextZ : (Z0Flat + this.personOption.thickness / 2 + 0.01), nextZ);\r\n                this.controls.getObject().position.z = nextZ\r\n            }\r\n\r\n            {//x轴碰撞检测\r\n                let X0Flat = undefined;//x负轴碰撞检测\r\n                let X0NearFlatTmp;\r\n                {\r\n                    for (let i = 0; i < 10; i++) {\r\n                        this.checkRay.X0[i].ray.origin.copy(this.controls.getObject().position);//设置射线原点在摄像机位置，即人物眼睛位置\r\n                        this.checkRay.X0[i].ray.origin.z = positionBeforeZ;\r\n                        this.checkRay.X0[i].ray.origin.z += (i % 2 === 0 ? 1 : -1) * rayMove;\r\n                        this.checkRay.X0[i].ray.origin.y += checkPositionOptions[Math.floor(i / 2)];\r\n                        let intersections = this.checkRay.X0[i].intersectObjects(this.objects);\r\n                        if (intersections.length > 0) {\r\n                            X0NearFlatTmp = intersections[0].point.x;\r\n                            X0Flat = Math.max(X0Flat === undefined ? X0NearFlatTmp : X0Flat, X0NearFlatTmp);\r\n                        }\r\n                    }\r\n                }\r\n                let X1Flat = undefined;//x正轴碰撞检测\r\n                let X1NearFlatTmp;\r\n                {\r\n                    for (let i = 0; i < 10; i++) {\r\n                        this.checkRay.X1[i].ray.origin.copy(this.controls.getObject().position);//设置射线原点在摄像机位置，即人物眼睛位置\r\n                        this.checkRay.X1[i].ray.origin.z = positionBeforeZ;\r\n                        this.checkRay.X1[i].ray.origin.z += (i % 2 === 0 ? 1 : -1) * rayMove;\r\n                        this.checkRay.X1[i].ray.origin.y += checkPositionOptions[Math.floor(i / 2)];\r\n                        let intersections = this.checkRay.X1[i].intersectObjects(this.objects);\r\n                        if (intersections.length > 0) {\r\n                            X1NearFlatTmp = intersections[0].point.x;\r\n                            X1Flat = Math.min(X1Flat === undefined ? X1NearFlatTmp : X1Flat, X1NearFlatTmp);\r\n                        }\r\n                    }\r\n                }\r\n                let nextX = this.controls.getObject().position.x;\r\n                nextX = Math.max(X0Flat === undefined ? nextX : (X0Flat + this.personOption.thickness / 2 + 0.01), nextX);\r\n                nextX = Math.min(X1Flat === undefined ? nextX : (X1Flat - this.personOption.thickness / 2 - 0.01), nextX);\r\n                this.controls.getObject().position.x = nextX\r\n                // console.log(Z0Flat,Z1Flat,X0Flat,X1Flat)\r\n            }\r\n            // console.log(this.controls.getObject().position.x,this.controls.getObject().position.y,this.controls.getObject().position.z)\r\n        }\r\n        //垂直方向移动+碰撞检测\r\n        {\r\n            let bottomFlatY = undefined;\r\n            //坠落四角检测\r\n            {\r\n                for (let i = 0; i < 4; i++) {\r\n                    this.checkRay.Y0[i].ray.origin.copy(this.controls.getObject().position);//设置射线原点在摄像机位置，即人物眼睛位置\r\n                }\r\n                let rayMove = this.personOption.thickness / 2;\r\n                this.checkRay.Y0[0].ray.origin.x += rayMove;\r\n                this.checkRay.Y0[0].ray.origin.z -= rayMove;\r\n                this.checkRay.Y0[1].ray.origin.x += rayMove;\r\n                this.checkRay.Y0[1].ray.origin.z += rayMove;\r\n                this.checkRay.Y0[2].ray.origin.x -= rayMove;\r\n                this.checkRay.Y0[2].ray.origin.z += rayMove;\r\n                this.checkRay.Y0[3].ray.origin.x -= rayMove;\r\n                this.checkRay.Y0[3].ray.origin.z -= rayMove;\r\n                for (let i = 0; i < 4; i++) {\r\n                    let intersections = this.checkRay.Y0[i].intersectObjects(this.objects);\r\n                    if (intersections.length > 0) {\r\n                        let bottomFlatYTmp = intersections[0].point.y;\r\n                        bottomFlatY = Math.max(bottomFlatY === undefined ? bottomFlatYTmp : bottomFlatY, bottomFlatYTmp);\r\n                    }\r\n                }\r\n            }\r\n            //头顶四角检测\r\n            let topFlatY = undefined;\r\n            {\r\n                for (let i = 0; i < 4; i++) {\r\n                    this.checkRay.Y1[i].ray.origin.copy(this.controls.getObject().position);//设置射线原点在摄像机位置，即人物眼睛位置\r\n                }\r\n                let rayMove = this.personOption.thickness / 2 - 0.001;\r\n                this.checkRay.Y1[0].ray.origin.x += rayMove;\r\n                this.checkRay.Y1[0].ray.origin.z -= rayMove;\r\n                this.checkRay.Y1[1].ray.origin.x += rayMove;\r\n                this.checkRay.Y1[1].ray.origin.z += rayMove;\r\n                this.checkRay.Y1[2].ray.origin.x -= rayMove;\r\n                this.checkRay.Y1[2].ray.origin.z += rayMove;\r\n                this.checkRay.Y1[3].ray.origin.x -= rayMove;\r\n                this.checkRay.Y1[3].ray.origin.z -= rayMove;\r\n                for (let i = 0; i < 4; i++) {\r\n                    let intersections = this.checkRay.Y1[i].intersectObjects(this.objects);\r\n                    if (intersections.length > 0) {\r\n                        let topFlatYTmp = intersections[0].point.y;\r\n                        topFlatY = Math.min(topFlatY === undefined ? topFlatYTmp : topFlatY, topFlatYTmp);\r\n                    }\r\n                }\r\n            }\r\n            //无碰撞时下次垂直位置(相机位置)\r\n            let nextY = this.controls.getObject().position.y + (this.velocity.y * delta);\r\n            if (topFlatY !== undefined) {\r\n                if (nextY > topFlatY - (this.personOption.height - this.personOption.sightHeight)) {\r\n                    nextY = topFlatY - (this.personOption.height - this.personOption.sightHeight)\r\n                    this.velocity.y = 0;\r\n                }\r\n            }\r\n            if (bottomFlatY !== undefined) {\r\n                //下方检测到平台时，脚部不能低于最低平台\r\n                nextY = Math.max(bottomFlatY + this.personOption.sightHeight, nextY);\r\n                if (nextY === bottomFlatY + this.personOption.sightHeight) {\r\n                    this.velocity.y = 0;\r\n                    this.canJump = true;\r\n                } else {\r\n                    this.velocity.y -= this.worldOption.g * Math.sqrt(delta);\r\n                }\r\n            } else {\r\n                //下方未检测到平台时\r\n                this.velocity.y -= this.worldOption.g * Math.sqrt(delta);\r\n            }\r\n            this.controls.getObject().position.y = nextY;\r\n        }\r\n        //掉落位置重置\r\n        if (this.controls.getObject().position.y < -500) {\r\n            this.velocity.y = 0;\r\n            this.controls.getObject().position.y = 500;\r\n            this.controls.getObject().position.x = 0;\r\n            this.controls.getObject().position.z = 0;\r\n        }\r\n        this.updatePreviewCube();\r\n    }\r\n\r\n    initMouseFunction() {\r\n        //点击功能\r\n        window.addEventListener('mousedown', (event) => {\r\n            let clickedObjects = getClickedObject(this.objects, this.camera);//this.scene.children\r\n            if (clickedObjects.length > 0) {\r\n                console.log(\"点击对象【\" + clickedObjects[0].object.name + \"】\", clickedObjects[0]);\r\n                if (\r\n                    clickedObjects[0]\r\n                    && clickedObjects[0].distance <= 10\r\n                    && clickedObjects[0].face && clickedObjects[0].face.normal\r\n                    && clickedObjects[0].object && clickedObjects[0].object.position\r\n                ) {\r\n                    let normal = clickedObjects[0].face.normal;\r\n                    let rotate = clickedObjects[0].object.rotation;\r\n                    let position = clickedObjects[0].object.position;\r\n                    let point = clickedObjects[0].point;\r\n\r\n                    let targetIsHalfCube = DefaultCube[clickedObjects[0].object.userData.cubeTypeKey].cubeAttributes && DefaultCube[clickedObjects[0].object.userData.cubeTypeKey].cubeAttributes.isHalfCube;\r\n                    let newIsHalfCube = DefaultCube[Object.keys(DefaultCube)[this.currentCubeTypeIndex]].cubeAttributes && DefaultCube[Object.keys(DefaultCube)[this.currentCubeTypeIndex]].cubeAttributes.isHalfCube;\r\n                    // this.objects.findIndex(e => e.userData)\r\n                    // console.log(normal.x, normal.y, normal.z, position.x, position.y, position.z)\r\n\r\n                    let newPositionVector = new THREE.Vector3(normal.x, normal.y, normal.z);\r\n                    newPositionVector = newPositionVector.applyAxisAngle(new THREE.Vector3(0, 0, 1), rotate.z);\r\n                    newPositionVector = newPositionVector.applyAxisAngle(new THREE.Vector3(0, 1, 0), rotate.y);\r\n                    newPositionVector = newPositionVector.applyAxisAngle(new THREE.Vector3(1, 0, 0), rotate.x);\r\n                    newPositionVector.round();\r\n\r\n                    let yMove = newPositionVector.y;\r\n                    {\r\n                        if (targetIsHalfCube) {\r\n                            if (newIsHalfCube) {\r\n                                if (newPositionVector.y !== 0) {\r\n                                    yMove = newPositionVector.y / 2\r\n                                }\r\n                            } else {\r\n                                if (newPositionVector.y !== 0) {\r\n                                    if (position.y > 0 ? position.y % 1 === 0.25 : position.y % 1 === -0.75) {\r\n                                        yMove = newPositionVector.y * (newPositionVector.y > 0 ? 3 : 5) / 4  //上半砖\r\n                                    } else {\r\n                                        yMove = newPositionVector.y * (newPositionVector.y > 0 ? 5 : 3) / 4  //下半砖\r\n                                    }\r\n                                } else {\r\n                                    if (position.y > 0 ? position.y % 1 === 0.25 : position.y % 1 === -0.75) {\r\n                                        yMove = -1 / 4  //上半砖\r\n                                    } else {\r\n                                        yMove = 1 / 4  //下半砖\r\n                                    }\r\n                                }\r\n                            }\r\n                        } else {\r\n                            if (newIsHalfCube) {\r\n                                if (newPositionVector.y !== 0) {\r\n                                    yMove = newPositionVector.y * 3 / 4;\r\n                                } else {\r\n                                    yMove = (point.y > position.y ? 1 : -1) / 4;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    let newPosition = {\r\n                        x: position.x + newPositionVector.x,\r\n                        y: position.y + yMove,\r\n                        z: position.z + newPositionVector.z,\r\n                    };\r\n\r\n                    if (!newIsHalfCube && checkPositionIsExistBlock(newPosition, this.objects)) {\r\n                        return;\r\n                    }\r\n                    if (event.button === 2) {//添加方块 右键\r\n                        //TODO 添加方块代码独立，方块不能添加到人物所站的地方\r\n                        let newDirectionRotate = {\r\n                            x: 0,\r\n                            y: 0,\r\n                            z: 0,\r\n                        };\r\n                        {//放置 转向\r\n                            let newDirection;\r\n                            let worldDirection = this.camera.getWorldDirection(new Vector3(1, 0, 0));\r\n                            if (Math.abs(worldDirection.x) >= Math.abs(worldDirection.z)) {\r\n                                newDirection = new Vector3(-worldDirection.x, 0, 0)\r\n                            } else {\r\n                                newDirection = new Vector3(0, 0, -worldDirection.z)\r\n                            }\r\n                            newDirection.normalize().round();\r\n                            if (Math.abs(worldDirection.y) >= 0.5) {\r\n                                newDirection.y = worldDirection.y > 0 ? 1 : -1\r\n                            }\r\n                            //水平旋转\r\n                            if (newDirection.x === 1) {\r\n                                newDirectionRotate.y = 0;\r\n                            } else if (newDirection.x === -1) {\r\n                                newDirectionRotate.y = 180;\r\n                            } else if (newDirection.z === 1) {\r\n                                newDirectionRotate.y = -90;\r\n                            } else if (newDirection.z === -1) {\r\n                                newDirectionRotate.y = 90;\r\n                            }\r\n                            //垂直旋转\r\n                            if (newDirection.y !== 0) {\r\n                                newDirectionRotate.z = newDirection.y > 0 ? -90 : 90;\r\n                            }\r\n                            newDirectionRotate.z += 90;//放置时方块顶部面冲玩家\r\n                        }\r\n                        let cubeFactory = new CubeFactory(DefaultCube[Object.keys(DefaultCube)[this.currentCubeTypeIndex]]);\r\n                        let cube = cubeFactory.buildCube(newPosition.x, newPosition.y, newPosition.z, DefaultCube[Object.keys(DefaultCube)[this.currentCubeTypeIndex]], 0, newDirectionRotate.y, newDirectionRotate.z);\r\n                        this.scene.add(cube);\r\n                        this.objects.push(cube)\r\n                    } else if (event.button === 0) {//删除方块 左键\r\n                        //TODO 改为长按同一方块时才删除\r\n                        // console.log(clickedObjects[0].object, this.scene.getObjectByName(clickedObjects[0].object.name));\r\n                        let index = this.objects.findIndex(e => e.id === clickedObjects[0].object.id);\r\n                        if (index >= 0) {\r\n                            this.objects.splice(index, 1);\r\n                        }\r\n                        this.scene.remove(this.scene.getObjectById(clickedObjects[0].object.id));\r\n                    }\r\n                }\r\n            }\r\n        }, false);\r\n        //滑轮功能\r\n        {\r\n            if (document.addEventListener) {//firefox\r\n                document.addEventListener('DOMMouseScroll', (e) => {\r\n                    e = e || window.event;\r\n                    if (e.wheelDelta) { //第一步：先判断浏览器IE，谷歌滑轮事件\r\n                        this.changeCurrentCubeTypeIndex(e.wheelDelta < 0);\r\n                    } else if (e.detail) { //Firefox滑轮事件\r\n                        this.changeCurrentCubeTypeIndex(e.detail < 0);\r\n                    }\r\n                }, false);\r\n            }\r\n            //滚动滑轮触发scrollFunc方法 //ie 谷歌\r\n            window.onmousewheel = (e) => {\r\n                console.log('滑轮', this.currentCubeTypeIndex);\r\n                e = e || window.event;\r\n                if (e.wheelDelta) { //第一步：先判断浏览器IE，谷歌滑轮事件\r\n                    this.changeCurrentCubeTypeIndex(e.wheelDelta < 0);\r\n                } else if (e.detail) { //Firefox滑轮事件\r\n                    this.changeCurrentCubeTypeIndex(e.detail < 0);\r\n                }\r\n            };\r\n        }\r\n    }\r\n\r\n    changeCurrentCubeTypeIndex(isNext) {\r\n        if (isNext) {\r\n            this.currentCubeTypeIndex++;\r\n            if (this.currentCubeTypeIndex === Object.keys(DefaultCube).length) {\r\n                this.currentCubeTypeIndex = 0;\r\n            }\r\n        } else {\r\n            if (this.currentCubeTypeIndex === 0) {\r\n                this.currentCubeTypeIndex = Object.keys(DefaultCube).length;\r\n            }\r\n            this.currentCubeTypeIndex--;\r\n        }\r\n    }\r\n\r\n    getCurrentCubeTypeIndex(plusValue) {\r\n        let result = this.currentCubeTypeIndex + (plusValue || 0) % Object.keys(DefaultCube).length;\r\n        if (result >= 0) {\r\n            return result;\r\n        } else {\r\n            return Object.keys(DefaultCube).length - 1 + result\r\n        }\r\n    }\r\n\r\n    initPreviewCube() {\r\n        this.previewCube = new CubeFactory(DefaultCube[Object.keys(DefaultCube)[this.currentCubeTypeIndex]]).buildCube();\r\n        this.scene.add(this.previewCube);\r\n    }\r\n\r\n    updatePreviewCube() {\r\n        //形状刷新\r\n        {\r\n            if (!this.previewCube.geometryMap) {\r\n                this.previewCube.geometryMap = {};\r\n            }\r\n\r\n            if (this.previewCubeType !== Object.keys(DefaultCube)[this.currentCubeTypeIndex]) {\r\n                this.previewCubeType = Object.keys(DefaultCube)[this.currentCubeTypeIndex];\r\n                if (this.previewCube.geometryMap[Object.keys(DefaultCube)[this.currentCubeTypeIndex]]) {\r\n                    this.previewCube.geometry = this.previewCube.geometryMap[Object.keys(DefaultCube)[this.currentCubeTypeIndex]]\r\n                } else {\r\n                    let previewGeometry = new CubeFactory(DefaultCube[Object.keys(DefaultCube)[this.getCurrentCubeTypeIndex()]])._geometry.clone();\r\n                    previewGeometry.scale(0.01, 0.01, 0.01);\r\n                    this.previewCube.geometry = previewGeometry;\r\n                    this.previewCube.geometryMap[Object.keys(DefaultCube)[this.currentCubeTypeIndex]] = previewGeometry;\r\n                }\r\n            }\r\n        }\r\n        //材质刷新\r\n        this.previewCube.material = new CubeFactory(DefaultCube[Object.keys(DefaultCube)[this.getCurrentCubeTypeIndex()]])._materials;\r\n        //位置刷新\r\n        this.previewCube.position.copy(this.camera.position);\r\n        //旋转刷新\r\n        {\r\n            {\r\n                if (!this.previewCubeRotation) {\r\n                    this.previewCubeRotation = {\r\n                        y: 0,\r\n                    }\r\n                } else {\r\n                    this.previewCubeRotation.y += Math.PI / 180;\r\n                }\r\n            }\r\n            this.previewCube.rotation.copy(this.camera.rotation);\r\n            this.previewCube.position.add(\r\n                new Vector3(0, -0.065, -0.2)\r\n                    .applyAxisAngle(new Vector3(0, 0, 1), this.camera.rotation.z)\r\n                    .applyAxisAngle(new Vector3(0, 1, 0), this.camera.rotation.y)\r\n                    .applyAxisAngle(new Vector3(1, 0, 0), this.camera.rotation.x)\r\n            );\r\n            this.previewCube.rotateY(Math.PI / 4 + this.previewCubeRotation.y)\r\n        }\r\n    }\r\n}\r\n\r\nfunction setAimStyle(aimEl) {\r\n    aimEl.style.position = \"fixed\";\r\n    aimEl.style.left = \"50%\";\r\n    aimEl.style.top = \"50%\";\r\n    aimEl.style.transform = \"translate(-50%,-50%)\";\r\n    aimEl.style.zIndex = \"1\";\r\n    aimEl.style.fontSize = \"100%\";\r\n    aimEl.style.fontWeight = \"bold\";\r\n    aimEl.style.textAlign = \"center\";\r\n    aimEl.style.verticalAlign = \"middle\";\r\n    aimEl.style.lineHeight = \"10px\";\r\n    aimEl.style.fontFamily = \"\\\"Times New Roman\\\",serif\";\r\n    aimEl.style.backgroundColor = \"#E0E0E0\";\r\n}\r\n\r\n//获取点击的对象\r\nfunction getClickedObject(objects, camera) {\r\n    let raycaster = new THREE.Raycaster();\r\n    let aim = new THREE.Vector2();\r\n    //通过鼠标点击的位置计算出raycaster所需要的点的位置，以屏幕中心为原点，值的范围为-1到1.\r\n    aim.x = 0;\r\n    aim.y = 0;\r\n    // 通过鼠标点的位置和当前相机的矩阵计算出raycaster\r\n    raycaster.setFromCamera(aim, camera);\r\n    // 获取raycaster直线和所有模型相交的数组集合\r\n    return raycaster.intersectObjects(objects);\r\n}\r\n\r\n//检测新方块要放的位置是否已经有放快了\r\nfunction checkPositionIsExistBlock(position, positionArray) {\r\n    for (let positionTmp of positionArray) {\r\n        if (Math.round(positionTmp.position.x) === Math.round(position.x)\r\n            &&\r\n            Math.round(positionTmp.position.y) === Math.round(position.y)\r\n            &&\r\n            Math.round(positionTmp.position.z) === Math.round(position.z)) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\n\r\n","import * as THREE from 'three'\r\nimport {WEBGL} from \"three/examples/jsm/WebGL.js\";\r\n// import TWEEN from \"@tweenjs/tween.js\";//动作库\r\nimport CubeFactory from \"./utils/objects/cube/CubeFactory.js\";\r\nimport StatsWindow from \"./utils/stats/StatsWindow.js\";\r\nimport {initAmbientLight, getAmbientLightIntensity, lightHighIntensity, lightLowIntensity, lightCurrentIntensity, lightValueBecomeHigher, initDirectionalLight, getDirectionalLightIntensity, initDirectionalLight1} from \"./utils/basic/Light\";\r\nimport {initBGMPlayer} from \"./utils/sound/Bgm\";\r\nimport {initScene} from \"./utils/basic/Scene\";\r\nimport {initCamera} from \"./utils/basic/Camera\";\r\nimport {initRenderer} from \"./utils/basic/Renderer\";\r\nimport {initControls} from \"./utils/controls/ControlBuilder\";\r\nimport DefaultCube from \"./utils/objects/cube/DefaultCube\";\r\nimport GlobalSetting from \"./utils/setting/GlobalSetting\";\r\nimport device from \"current-device\";\r\n// 检查设备\r\nif (device.type === 'mobile') {\r\n    let divEl = document.createElement('div');\r\n    divEl.style.position = \"absolute\";\r\n    divEl.style.top = \"35%\";\r\n    divEl.style.width = \"100%\";\r\n    divEl.style.zIndex = \"1000\";\r\n    divEl.style.textAlign = 'center';\r\n    divEl.style.fontWeight = 'bold';\r\n    divEl.style.color = 'gray';\r\n    divEl.style.fontSize = '1em';\r\n    let spanEl1 = document.createElement('span');\r\n    spanEl1.style.fontSize = '1.5em';\r\n    spanEl1.innerText = \"手机不可以 :(\";\r\n    let spanEl2 = document.createElement('span');\r\n    spanEl2.innerText = \"Cell phone is not OK :(\";\r\n    let spanEl3 = document.createElement('span');\r\n    spanEl3.style.fontSize = '1.5em';\r\n    spanEl3.innerText = \"还是用电脑试试吧 :)\";\r\n    let spanEl4 = document.createElement('span');\r\n    spanEl4.innerText = \"Let's try it with computer :)\";\r\n    divEl.append(spanEl1, document.createElement('br'), spanEl2, document.createElement('br'), spanEl3, document.createElement('br'), spanEl4);\r\n    document.body.appendChild(divEl);\r\n    throw \"unsupport platform\";\r\n}\r\n\r\nif (!WEBGL.isWebGLAvailable()) {\r\n    let divEl = document.createElement('div');\r\n    divEl.style.position = \"absolute\";\r\n    divEl.style.top = \"35%\";\r\n    divEl.style.width = \"100%\";\r\n    divEl.style.zIndex = \"1000\";\r\n    divEl.style.textAlign = 'center';\r\n    divEl.style.fontWeight = 'bold';\r\n    divEl.style.color = 'gray';\r\n    divEl.style.fontSize = '1em';\r\n    let spanEl1 = document.createElement('span');\r\n    spanEl1.style.fontSize = '1.5em';\r\n    spanEl1.innerText = \"这个浏览器不太行 :(\";\r\n    let spanEl2 = document.createElement('span');\r\n    spanEl2.innerText = \"This browser doesn't work well :(\";\r\n    let spanEl3 = document.createElement('span');\r\n    spanEl3.style.fontSize = '1.5em';\r\n    spanEl3.innerText = \"还是用流行的浏览器试试吧 :)\";\r\n    let spanEl4 = document.createElement('span');\r\n    spanEl4.innerText = \"Let's try it with a popular browser :)\";\r\n    divEl.append(spanEl1, document.createElement('br'), spanEl2, document.createElement('br'), spanEl3, document.createElement('br'), spanEl4);\r\n    document.body.appendChild(divEl);\r\n    document.body.appendChild(WEBGL.getWebGLErrorMessage());\r\n    throw \"unsupport browser\";\r\n}\r\n//------------------------------------初始化基本对象-结束------------------------------------------------\r\nlet canvasEL = document.getElementById(\"canvas-frame\");\r\n// 舞台*\r\nlet scene = initScene();\r\n// 光源*\r\nlet lightAmbient = initAmbientLight();\r\nscene.add(lightAmbient);\r\nlet lightDirectional;\r\nif (GlobalSetting.enableShadow) {\r\n    lightDirectional = initDirectionalLight();\r\n    scene.add(lightDirectional);\r\n}\r\n\r\n// 相机*\r\nlet camera = initCamera();\r\ncamera.aspect = canvasEL.offsetWidth / canvasEL.offsetHeight;\r\ncamera.updateProjectionMatrix();\r\nscene.add(camera);\r\n// 渲染器*\r\nlet renderer = initRenderer();\r\nrenderer.setSize(canvasEL.offsetWidth, canvasEL.offsetHeight);\r\nrenderer.setPixelRatio(window.devicePixelRatio);\r\ndocument.getElementById('canvas-frame').appendChild(renderer.domElement);\r\n// 收集所欲加入到场景的方块对象\r\nlet objects = [];\r\n// 相机控制器\r\nlet controls = initControls(\"MCFirstPersonControl\", scene, camera, renderer, objects);\r\n//------------------------------------初始化基本对象-结束------------------------------------------------\r\n//-----------以下为物体添加代码---------------------------------------------------------------\r\nlet lightOption = {\r\n    current: lightCurrentIntensity,\r\n    low: lightLowIntensity,\r\n    high: lightHighIntensity,\r\n    becomeHigher: lightValueBecomeHigher\r\n};\r\n\r\nfunction changeLight() {\r\n    lightAmbient.intensity = getAmbientLightIntensity(lightOption.current, lightOption.high, lightOption.low);\r\n    if (GlobalSetting.enableShadow) {\r\n        lightDirectional.intensity = getDirectionalLightIntensity(lightOption.current, lightOption.high, lightOption.low);\r\n    }\r\n    if (lightOption.becomeHigher) {\r\n        let tmp = lightOption.current >= lightOption.low - (lightOption.high - lightOption.low);\r\n        if (tmp) {\r\n            lightOption.current -= 0.002;\r\n        } else {\r\n            lightOption.becomeHigher = false;\r\n        }\r\n    } else {\r\n        if (lightOption.current <= lightOption.high + (lightOption.high - lightOption.low)) {\r\n            lightOption.current += 0.002;\r\n        } else {\r\n            if (lightOption.current > 1.5) {\r\n                lightOption.becomeHigher = true;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n(function addGrassCubes() {\r\n    let cubeFactory = new CubeFactory(DefaultCube.grass);\r\n    {\r\n        let testBlock = [];\r\n        let width = 10;\r\n        //底板\r\n        for (let x = -width; x < width; x++) {\r\n            for (let z = -width; z < width; z++) {\r\n                testBlock.push([x, -1, z]);\r\n            }\r\n        }\r\n        //阶梯\r\n        for (let x = 0; x < 5; x++) {\r\n            for (let z = 0; z < 5; z++) {\r\n                for (let y = 0; y < 5; y++) {\r\n                    if (y >= x) {\r\n                        testBlock.push([x - 7, y - x, z - 7])\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        //土堆\r\n        {\r\n            let mountainHeight = 4;\r\n            for (let y = 0; y < mountainHeight; y++) {\r\n                for (let x = y; x < 2 * mountainHeight - y; x++) {\r\n                    for (let z = y; z < 2 * mountainHeight - y; z++) {\r\n                        testBlock.push([x - 5, y, z + 1])\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        //碰撞检测用\r\n        {\r\n            for (let x = 0; x < 5; x++) {\r\n                for (let z = 0; z < 5; z++) {\r\n                    if (x !== 2 || z !== 2) {\r\n                        testBlock.push([x, 0, z - 5]);\r\n                    }\r\n                }\r\n            }\r\n            testBlock.push([0, 1, -5]);\r\n            testBlock.push([3, 3, -5]);\r\n            testBlock.push([2, 3, -5]);\r\n            testBlock.push([3, 3, -4]);\r\n            testBlock.push([2, 3, -4]);\r\n            testBlock.push([3, 3, -6]);\r\n            testBlock.push([2, 3, -6]);\r\n            testBlock.push([3, 3, -7]);\r\n            testBlock.push([2, 3, -7]);\r\n            testBlock.push([3, 2, -8]);\r\n            testBlock.push([2, 2, -8]);\r\n            testBlock.push([5, 2, -4]);\r\n            testBlock.push([4, 2, -4]);\r\n        }\r\n\r\n        let zValue = -10;\r\n        let xValue = 8;\r\n        let yValue = 1;\r\n        for (let cubeType of Object.values(DefaultCube)) {\r\n            let idHalfCube = cubeType.cubeAttributes && cubeType.cubeAttributes.isHalfCube;\r\n            testBlock.push([xValue, idHalfCube ? yValue - 1 / 4 : yValue, zValue++, cubeType]);\r\n            if (zValue === 10) {\r\n                yValue++;\r\n                zValue = -10;\r\n            }\r\n        }\r\n\r\n        testBlock.push([0, 15, 0, DefaultCube.grass]);\r\n\r\n\r\n        for (let cubeInfo of testBlock) {\r\n            let cube = cubeFactory.buildCube(...cubeInfo);\r\n\r\n            scene.add(cube);\r\n            objects.push(cube);\r\n        }\r\n    }\r\n})();\r\n\r\nlet prevTime = performance.now();\r\n\r\n(function animate() {\r\n    requestAnimationFrame(animate);\r\n    let time = performance.now();\r\n    let delta = (time - prevTime) / 1000;\r\n    prevTime = time;\r\n    // TWEEN.update(delta);\r\n    controls.update();\r\n    renderer.render(scene, camera);\r\n    new StatsWindow(\"canvas-frame\").stats.update(delta);\r\n    changeLight();\r\n})();\r\n\r\nwindow.onresize = () => {\r\n    //更新相机视角比例\r\n    camera.aspect = canvasEL.offsetWidth / canvasEL.offsetHeight;\r\n    camera.updateProjectionMatrix();\r\n    renderer.setSize(canvasEL.offsetWidth, canvasEL.offsetHeight);\r\n};\r\n\r\nwindow.onload = () => {\r\n    initBGMPlayer();\r\n};\r\n","import * as THREE from 'three';\r\nexport function initScene() {\r\n    let scene = new THREE.Scene();\r\n    let backgroundColor= 0x87CEEB;\r\n    scene.name = 'SCENE';\r\n    scene.fog = new THREE.FogExp2(backgroundColor, 0.005);//雾效果\r\n    //增加天空盒\r\n    (function skyBox(backgroundType) {\r\n        backgroundType = backgroundType || 1;\r\n        let textureCube = new THREE.CubeTextureLoader().load([\r\n            './assets/img/1.png',\r\n            './assets/img/2.png',\r\n            './assets/img/3.png',\r\n            './assets/img/4.png',\r\n            './assets/img/5.png',\r\n            './assets/img/6.png'\r\n        ]);\r\n        if (backgroundType === 1) {//使用场景背景添加\r\n            scene.background = new THREE.Color(backgroundColor);\r\n        } else if (backgroundType === 2) {\r\n            scene.background = textureCube\r\n        } else {//使用盒子添加\r\n            //着色器\r\n            let cubeShader = THREE.ShaderLib[\"cube\"];\r\n            cubeShader.uniforms[\"tCube\"].value = textureCube;\r\n            let material = new THREE.ShaderMaterial({\r\n                fragmentShader: cubeShader.fragmentShader,  //定义自己的片元着色器\r\n                vertexShader: cubeShader.vertexShader,  //定义自己的顶点着色器\r\n                uniforms: cubeShader.uniforms,  //给着色器传入uniform变量的值\r\n                depthWrite: false,  //决定这个材质是否影响WebGL的深度缓存\r\n                side: THREE.BackSide,  //侧面：反面\r\n            });\r\n            //创建方盒子\r\n            let cubeWithPic = new THREE.Mesh(new THREE.CubeGeometry(1000000, 1000000, 1000000), material);\r\n            scene.add(cubeWithPic);\r\n        }\r\n    })(1);\r\n    return scene;\r\n}","import * as THREE from \"three\";\r\n\r\nexport function initCamera() {\r\n    let camera = new THREE.PerspectiveCamera();\r\n    camera.name = \"CAMERA\";\r\n    camera.fov = 45; //fov表示摄像机视锥体垂直视野角度，最小值为0，最大值为180，默认值为50，实际项目中一般都定义45，因为45最接近人正常睁眼角度\r\n    // camera.aspect = width / height; //aspect表示摄像机视锥体长宽比，默认长宽比为1，即表示看到的是正方形，实际项目中使用的是屏幕的宽高比\r\n    camera.near = 0.1; //near表示摄像机视锥体近端面，这个值默认为0.1，实际项目中都会设置为1\r\n    camera.far = 1000; //far表示摄像机视锥体远端面，默认为2000，这个值可以是无限的，说的简单点就是我们视觉所能看到的最远距离\r\n    camera.position.x = 0;\r\n    camera.position.y = 10;\r\n    camera.position.z = 0;\r\n    return camera;\r\n}","import * as THREE from \"three\";\r\nimport GlobalSetting from \"../setting/GlobalSetting\";\r\n\r\nexport function initRenderer() {\r\n    let renderer = new THREE.WebGLRenderer();\r\n    renderer.name = 'RENDERER';\r\n    // renderer.antialias = true;//是否开启反锯齿\r\n    renderer.shadowMap.enabled =  GlobalSetting.enableShadow;\r\n    // renderer.shadowMap.type = THREE.PCFSoftShadowMap;//更柔和的影子，需要的性能更高\r\n    // renderer.setSize(width, height);\r\n    renderer.setClearColor(0xFFFFFF, 1.0);//背景颜色\r\n    return renderer\r\n}","import ShowOrbitControl from \"./ShowOrbitControl\";\r\nimport MCFirstPersonControl from \"./MCFirstPersonControl\";\r\n\r\nexport function initControls(controlsType,scene,camera,renderer,objects) {\r\n    let controls;\r\n    switch (controlsType) {\r\n        case \"ShowOrbitControl\":\r\n            let showOrbitControl = new ShowOrbitControl(camera, renderer.domElement);\r\n            showOrbitControl.initClickFunction(scene.children);\r\n            controls = showOrbitControl.controls;\r\n            break;\r\n        case \"MCFirstPersonControl\":\r\n            let mcFirstPersonControl = new MCFirstPersonControl(camera, renderer.domElement, objects, scene);\r\n            controls = mcFirstPersonControl;\r\n            break;\r\n    }\r\n    return controls;\r\n}","\r\nexport  function initBGMPlayer() {\r\n    let audioBGM;\r\n    let currentIndex = 0;\r\n    let arr = [//把需要播放的歌曲从后往前排，这里已添加两首音乐，可继续添加多个音乐\r\n        \"./assets/sound/calm1.ogg\",\r\n        \"./assets/sound/calm2.ogg\",\r\n        \"./assets/sound/calm3.ogg\",\r\n        \"./assets/sound/hal1.ogg\",\r\n        \"./assets/sound/hal2.ogg\",\r\n        \"./assets/sound/hal3.ogg\",\r\n        \"./assets/sound/hal4.ogg\",\r\n    ];\r\n    audioBGM = new Audio();\r\n    audioBGM.preload = \"true\";\r\n    audioBGM.controls = true;\r\n    audioBGM.autoplay = true;\r\n    // audioBGM.muted = true;\r\n    audioBGM.hidden = true;\r\n    audioBGM.style.display = \"none\";\r\n    audioBGM.style.position = \"fixed\";\r\n    audioBGM.style.top = \"0\";\r\n    audioBGM.style.right = \"0\";\r\n    audioBGM.style.zIndex = \"101\";\r\n    audioBGM.loop = false;//禁止循环，否则无法触发ended事件\r\n    audioBGM.src = arr[currentIndex];         //每次读数组最后一个元素\r\n    audioBGM.addEventListener('ended', playEndedHandler, false);\r\n    document.addEventListener('click', playHandler, false);\r\n    // audioBGM.play();\r\n    document.body.appendChild(audioBGM);\r\n\r\n    function playEndedHandler() {\r\n        currentIndex++;\r\n        if (currentIndex >= arr.length) {\r\n            currentIndex = 0;\r\n        }\r\n        audioBGM.src = arr[currentIndex];\r\n        audioBGM.play();\r\n        // myAudio.removeEventListener('ended', playEndedHandler, false);\r\n    }\r\n\r\n    function playHandler() {\r\n        audioBGM.play();\r\n        document.removeEventListener('click', playHandler, false);\r\n    }\r\n    return audioBGM;\r\n}"],"sourceRoot":""}